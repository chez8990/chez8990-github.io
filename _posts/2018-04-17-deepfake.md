---
layout: post
title: Deepfake
---

Deepfake has had a lot of traction in the past few months, due to its unforseen application in the porn industry. Most people were interested to use it for their own pleasure but few people actually cared for the core technology. In this blog post we try to explore the architecture of deepfake and how deep learning is used to make this, seemingly miraculous, application possible.

### What is deepfake?
Deepfake is a deep learning based image recreation algorithm that allows users to superimpose facial images. It's been widely used to create fake celebrity pornogrphic videos. There was an entire subreddit dedicated to the maintainence and development of the "fakeapp" before its eventual demise. 

### Autoencoder
An autoencoder is a deep neural network atchitecture that is used in unsupervised learning, it consists of three parts, an encoder, a decoder and a latent space. The goal of an autoencoder is to encode high dimensional data to a low dimensional subspace by means of feature learning. [See more](/autoencoder)

We will be using autoencoders to come up with low dimensional representation of face images, as well as generation of new face images.

### Structure 

The autoencoder we will be using is as follows

{: .center}
![structure](/images/oliver_falon.png)

So essentially, there are 1 encoder responsible for embedding the faces and 2 decoders to reconstruct the respective faces. To make an inference, i.e input face A and output face B, one simply uses an image of face A, get a latent representation and pass it throught the decoder of face B. 

Here are some code implementing the above idea in keras.

{% gist 8387126 %}
from keras.models import Model
from keras.layers import Conv2D, MaxPooling2D, Input, UpSampling2D

def input_tensor(image_shape):
    return Input(shape=image_shape)

def encoder(input_tensor):
    x = Conv2D(16, (3, 3), activation='relu', padding='same')(input_tensor)
    x = MaxPooling2D((2, 2), padding='same')(x)
    x = Conv2D(8, (3, 3), activation='relu', padding='same')(x)
    x = MaxPooling2D((2, 2), padding='same')(x)
    x = Conv2D(8, (3, 3), activation='relu', padding='same')(x)
    encoded = MaxPooling2D((2, 2), padding='same')(x)
    
    return encoded

def decoder(encoded_tensor):
    x = Conv2D(8, (3, 3), activation='relu', padding='same')(encoded_tensor)
    x = UpSampling2D((2, 2))(x)
    x = Conv2D(8, (3, 3), activation='relu', padding='same')(x)
    x = UpSampling2D((2, 2))(x)
    x = Conv2D(16, (3, 3), activation='relu', padding='same')(x)
    x = UpSampling2D((2, 2))(x)
    decoded = Conv2D(3, (3, 3), activation='sigmoid', padding='same')(x)
    
    return decoded

image_shape = (64, 64, 3)

input_img = input_tensor(image_shape)
encoder = encoder(input_img)
decoder_1 = decoder(encoder)
decoder_2 = decoder(encoder)

autoencoder_1 = Model(input_img, decoder_1)
autoencoder_2 = Model(input_img, decoder_2)

autoencoder_1.compile(optimizer='adam', loss='mean_squared_error')
autoencoder_2.compile(optimizer='adam', loss='mean_squared_error')




#### References
https://hackernoon.com/exploring-deepfakes-20c9947c22d9

https://blog.keras.io/building-autoencoders-in-keras.html
